<?php

$basepath = 'uploads/';
$realBase = realpath($basepath);

$userpath = $basepath . $_GET['src'];
$realUserPath = realpath($userpath);

if ($realUserPath === false || strpos($realUserPath, $realBase) !== 0) {
    //Directory Traversal!
} else {
    $result = $_GET['src'];
    header('Content-Type: image/png');
    $name = "uploads/" . $result;
    readfile($name);
}

?>
